## 字符、字符串和文本处理



### 字符

> .Net Framework中，字符总是表示成16位Unicode代码值。
>
> 每个字符都是`System.Char`接口(一个值类型)的实例。它提供了两个公共只读常量字段：`MinValue` ('\0') 和`MaxValue` ('\ufff')。

#### 大小写转换

```C#
String name = "WeiQiang";

// 转换大小写(以忽略语言文化的方式)
var lower1 = name.ToLowerInvariant();
var upper1 = name.ToUpperInvariant();
// 转换大小写(使用与调用线程关联的语言文化信息)(方法在内部查询System.Threading.Thread.CurrentCulture)
var lower2 = name.ToLower();
var upper2 = name.ToUpper();
```

#### 比较字符

* `Equals()` 判断两个_Char_ 实例是否代表同一个16位_Unicode_ 码位。
* `CompareTo()` 返回两个_Char_ 实例忽略语言文化的比较结果。
* `GetNumbericValue()` 返回字符的数值形式。

#### 类型转换

```C#
// 转型（强制类型转换）
var a = (Char)65;

// 使用 `Convert` 类型
var a = Convert.ToInt32("65");

// 使用 `IConvertible` 接口。（效率最差，需要装箱）
var a = ((IConvertible)65).ToInt32(null);
```



---



### `System.String` 类型

> 一个 `String` 代表一个不可变_(immutable)_ 的顺序字符集。
>
> `String` 类型直接派生自 `Object`，所以是**引用类型**。因此，它的对象(字符数组)总是存在于堆上，永远不会跑到线程栈。
>
> C# 不允许使用 `new` 操作符从字面值字符串构造 `String` 对象。

#### 构造字符串

```C#
// 回车换行符
String str = "Hello" + Environment.NewLine + "World!";
```

#### 字符串是不可变的

> 如果要执行大量的字符串操作，会在堆上创建大量的 `String` 对象，造成更频繁的垃圾回收。建议使用 `StringBuilder`。

#### 比较字符串

* 一般有两个原因需要比较字符串：1：判断相等性；2：排序。
  * 排序时应该总是执行区分大小写的比较，否则每次排序输出的结果可能不同。

* 使用 `StringComparison.Ordinal` 或 `StringComparison.OrdinalIgnoreCase`
  * 处于编程目的比较字符串时，忽略语言文化时字符串比较最快的方式。
* 使用 `ToUpperInvariant()`方法比较字符串。
  * 因为_Microsoft_ 对执行大写比较的代码进行了优化，不适用 `ToUpper()` 是因为它对语言文化敏感。
* `Compare` 返回 _Int32_ 值。
  * `非零` 表示不相等， `零` 表示相等。非零和零分别对应 `true` 和 `false`。

#### ~~字符串留用~~

> `Intern()` `IsIntern()`
>
> 比较字符串，不建议使用，C#编译器默认不启用。

#### 字符串池





